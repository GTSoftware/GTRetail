<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:gtsoftware="http://java.sun.com/jsf/composite/gtsoftware">

    <div class="Container100 Responsive100 NoIndent">
        <div class="Container100 ui-fluid">
            <div class="Card">
                <h1 class="CardBigTopic TexAlCenter">Ingresar Mercaderia</h1>
                <div class="SeparatorFull" />

                <h:form id="formContenido">


                    <p:panel header="#{msg.proveedores}">

                        <p:panelGrid layout="grid"
                                     id="proveedorGrid"
                                     style="border:0px !important; background:none;"
                                     styleClass="ui-panelgrid-blank"
                                     columnClasses="ui-grid-col-2, ui-grid-col-3, ui-grid-col-1"
                                     columns="3"
                                     >

                            <p:outputLabel value="#{msg.proveedor}: "/>
                            <p:inputText value="#{ingresoMercaderiaBean.remitoCabecera.idOrigenExterno.businessString}"
                                         disabled="true"
                                         />


                            <p:commandButton id="buscarProveedorButton" icon="fa fa-fw fa-search"
                                             title="#{msg.buscar} proveedores"
                                             oncomplete="PF('proveedoresDialog').show()"
                                             process="@none"
                                             global="false"/>

                        </p:panelGrid >
                    </p:panel>


                    <div class="SeparatorFull" />

                    <p:panel header="#{msg.productos}">

                        <p:panelGrid layout="grid"
                                     id="productosGrid"
                                     style="border:0px !important; background:none;"
                                     styleClass="ui-panelgrid-blank"
                                     columns="2"
                                     columnClasses="ui-grid-col-2, ui-grid-col-3, ui-grid-col-1"
                                     >

                            <p:outputLabel value="#{msg.codigo}: "/>

                            <p:panelGrid layout="grid"
                                         id="detalleGrid"
                                         style="border:0px !important; background:none;"
                                         styleClass="ui-panelgrid-blank" columns="2"
                                         >
                                <p:outputLabel
                                    value="#{ingresoMercaderiaBean.remitoDetalle.idProducto.id}"
                                    />
                                <p:commandButton id="buscarProductoButton"
                                                 icon="fa fa-fw fa-search"
                                                 title="#{msg.buscar} productos"

                                                 oncomplete="PF('productDialog').show()"
                                                 process="@none"
                                                 global="false"/>

                            </p:panelGrid>



                            <p:outputLabel value="#{msg.descripcion}"/>
                            <p:inputText value="#{ingresoMercaderiaBean.remitoDetalle.idProducto.descripcion}"/>

                            <p:outputLabel value="#{msg.cantidad}"/>
                            <p:inputText value="#{ingresoMercaderiaBean.remitoDetalle.cantidad}"
                                         required="true"
                                         requiredMessage="Debe ingresar una cantidad">
                                <f:validateDoubleRange minimum="0.01"
                                                       maximum="9999999999999999999.99" />
                            </p:inputText>



                        </p:panelGrid>

                    </p:panel>

                    <div class="EmptyBox10" />
                    <p:commandButton id="addDetalleButton"
                                     icon="fa fa-plus-square"
                                     value="#{msg.agregarLinea}"
                                     action="#{ingresoMercaderiaBean.agregarLinea()}"
                                     update="productosTable productosGrid"
                                     immediate="false"

                                     />

                    <div class="EmptyBox10"/>
                    <p:panel header="#{msg.detalle}">
                        <p:dataTable id="productosTable"
                                     var="lineaDetalle"
                                     value="#{ingresoMercaderiaBean.remitoCabecera.detalleList}"
                                     paginator="false"
                                     sortMode="single"
                                     emptyMessage="#{msg.productosNoCargados}"
                                     editable="true"
                                     editMode="cell"
                                     reflow="true"
                                     liveResize="true">


                            <p:column style="text-align: right; ">
                                <f:facet name="header">
                                    #{msg.tablaId}
                                </f:facet>
                                <h:outputText value="#{lineaDetalle.idProducto.id}" />
                            </p:column>
                            <p:column style="text-align: left; ">
                                <f:facet name="header">
                                    #{msg.codigo}
                                </f:facet>
                                <h:outputText value="#{lineaDetalle.idProducto.codigoPropio}" />
                            </p:column>
                            <p:column style="text-align: left; ">
                                <f:facet name="header">
                                    #{msg.tablaDescripcion}
                                </f:facet>
                                <h:outputText id="decripcionProd" value="#{lineaDetalle.idProducto.descripcion}" />
                                <p:tooltip id="toolTipFade" for="decripcionProd"  value="#{lineaDetalle.idProducto.observaciones}" />
                            </p:column>
                            <p:column style="text-align: right;">
                                <f:facet name="header">
                                    #{msg.tablaCantidad}
                                </f:facet>
                                <p:cellEditor>
                                    <f:facet name="output">
                                        <h:outputText value="#{lineaDetalle.cantidad}" />
                                    </f:facet>
                                    <f:facet name="input">
                                        <p:inputText id="cantidadProdTabField" value="#{lineaDetalle.cantidad}" >
                                            <f:validateDoubleRange minimum="0.01"
                                                                   maximum="9999999999999999999.99" />
                                        </p:inputText>
                                    </f:facet>
                                </p:cellEditor>

                            </p:column>



                        </p:dataTable>
                        <div class="EmptyBox20"/>
                        <p:commandButton id="ingresarMercaderia" icon="fa fa-floppy-o"
                                         value="#{msg.guardar}"
                                         action="#{ingresoMercaderiaBean.confirmarIngreso()}"
                                         immediate="true"
                                         />


                    </p:panel>



                </h:form>
            </div>
        </div>
    </div>

    <p:dialog header="#{msg.proveedores}"
              widgetVar="proveedoresDialog"
              resizable="true"
              id="proveedoresDialog"
              closeOnEscape="true"
              showEffect="fade"
              hideEffect="clip"
              modal="true">
        <h:form id="buscarProveedoresForm">



            <gtsoftware:busquedaProveedor id="busqueProveedores"
                                          personaSeleccionada="#{ingresoMercaderiaBean.remitoCabecera.idOrigenExterno}"

                                          />


            <p:commandButton id="buscarPersonaOkButton" icon="fa fa-check-circle"
                             title="#{msg.ok}"
                             oncomplete="PF('proveedoresDialog').hide()"
                             update=":formContenido:proveedorGrid"
                             global="false"/>
        </h:form>

    </p:dialog>

    <p:dialog header="#{msg.productos}"
              widgetVar="productDialog"
              resizable="true"
              id="productDialog"
              closeOnEscape="true"
              showEffect="fade"
              hideEffect="clip"
              modal="true">
        <h:form id="buscarProductForm">



            <gtsoftware:busquedaProductos id="busquedaProducto"
                                          productoSeleccionado="#{ingresoMercaderiaBean.remitoDetalle.idProducto}"                                        />


            <p:commandButton id="buscarProductoOkButton" icon="fa fa-check-circle"
                             title="#{msg.ok}"
                             oncomplete="PF('productDialog').hide()"
                             update=":formContenido:productosGrid"
                             global="false"/>
        </h:form>

    </p:dialog>
</html>
