<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core">

    <h:form id="actualizarPreciosForm">
        <!-- Permitir actualizar el costo en un porcentaje y armar la parte de filtros primero -->


        <p:panel header="#{msg.filtros}">
            <p:panelGrid layout="grid"  styleClass="ui-panelgrid-blank" id="clasificacionGrid" columns="3" >
                <h:outputLabel for="tipoProveeduriaField" value="#{msg.tipoProveeduria}:"/>
                <p:selectOneMenu id="tipoProveeduriaField" value="#{productosPreciosBean.filter.idTipoProveeduria}"

                                 converter="#{productosTiposProveeduriaConverter}"
                                 >
                    <f:selectItem  noSelectionOption="false" itemLabel="#{msg.todos}"  itemValue="#{null}"/>

                    <f:selectItems value="#{productosPreciosBean.tiposProveeduriaList}" var="tipoProd"
                                   itemLabel="#{tipoProd.nombreTipoProveeduria}"
                                   itemValue="#{tipoProd}"/>

                </p:selectOneMenu>
                <p:message for="tipoProveeduriaField"/>

                <h:outputLabel for="proveedorHabitualField" value="#{msg.proveedor}:"/>
                <p:selectOneMenu id="proveedorHabitualField" value="#{productosPreciosBean.filter.idProveedorHabitual}"
                                 converter="#{personasConverter}"
                                 required="false" requiredMessage="#{msg.seleccionarUno}"
                                 filter="true"
                                 filterMatchMode="contains">
                    <f:selectItem  noSelectionOption="false" itemLabel="#{msg.todos}"  itemValue="#{null}"/>
                    <f:selectItems value="#{productosPreciosBean.proveedoresList}" var="proveedor"
                                   itemLabel="#{proveedor.nombreFantasia + ' - ' + proveedor.razonSocial}"
                                   itemValue="#{proveedor}"/>

                </p:selectOneMenu>
                <p:message for="proveedorHabitualField"/>

                <h:outputLabel for="rubroField" value="#{msg.productoRubro}:" />
                <h:panelGroup >
                    <p:selectOneMenu id="rubroField"  value="#{productosPreciosBean.filter.idRubro}"

                                     converter="#{productosRubrosConverter}"
                                     label="#{msg.productoRubro}"
                                     >

                        <f:selectItem  noSelectionOption="false" itemLabel="#{msg.todos}"  itemValue="#{null}"/>
                        <f:selectItems value="#{productosPreciosBean.rubrosList}" var="rubro"
                                       itemLabel="#{rubro.nombreRubro}" itemValue="#{rubro}"/>
                        <p:ajax event="valueChange"
                                update=":actualizarPreciosForm:subRubroPanelGroup"  process="@this"/>
                    </p:selectOneMenu>


                </h:panelGroup>
                <p:message for="rubroField"/>


                <h:outputLabel for="subRubroField" value="#{msg.productoSubRubro}:" />
                <h:panelGroup id="subRubroPanelGroup">

                    <p:selectOneMenu id="subRubroField" value="#{productosPreciosBean.filter.idSubRubro}"
                                     required="false" converter="#{productosSubRubrosConverter}"
                                     requiredMessage="#{msg.seleccionarUno}"
                                     label="#{msg.productoSubRubro}"
                                     >

                        <f:selectItem  noSelectionOption="false" itemLabel="#{msg.todos}" itemValue="#{null}" />
                        <f:selectItems value="#{productosPreciosBean.subRubrosList}" var="subRubro"
                                       itemLabel="#{subRubro.nombreSubRubro}" itemValue="#{subRubro}"/>
                    </p:selectOneMenu>


                </h:panelGroup>
                <p:message for="subRubroField"/>


                <h:outputLabel for="marcaField" value="#{msg.marca}:" />
                <h:panelGroup >
                    <p:selectOneMenu id="marcaField" value="#{productosPreciosBean.filter.idMarca}"
                                     required="flase" requiredMessage="#{msg.ingresarValor}"
                                     converter="#{productosMarcasConverter}"
                                     label="#{msg.marca}">
                        <f:selectItem noSelectionOption="false" itemLabel="#{msg.todos}" itemValue="#{null}"/>
                        <f:selectItems value="#{productosPreciosBean.marcasList}" var="marca"
                                       itemLabel="#{marca.nombreMarca}" itemValue="#{marca}"/>

                    </p:selectOneMenu>

                </h:panelGroup>
                <p:message for="marcaField"/>

                <h:outputLabel for="txtField" value="#{msg.terminosBusqueda}:"  />
                <p:inputText id="txtField" value="#{productosPreciosBean.filter.txt}"
                             label="#{msg.terminosBusqueda}" size="100"/>
                <p:message for="txtField"/>
            </p:panelGrid >
            <p:commandButton id="aplicarFiltrosButton"
                             value="#{msg.aplicarFiltros}"
                             icon="fa fa-fw fa-search"
                             update="@form"
                             ajax="true"
                             />

            <h:outputLabel for="cantProd" value="#{msg.cantidadProductosEditar}:"  />
            <h:outputLabel id="cantProd"  value="#{productosPreciosBean.cantidadProductosAEditar}"  />
        </p:panel>

        <p:panel header="#{msg.actualizarCosto}">

            <p:panelGrid layout="grid"  styleClass="ui-panelgrid-blank" columns="3">
                <p:outputLabel for="porcentajeCostoField" value="#{msg.porcentaje}:" />
                <p:inputText id="porcentajeCostoField" value="#{productosPreciosBean.porcentajeCosto}"
                             style="text-align: right"
                             label="#{msg.porcentaje}"
                             title="Ingrese un valor positivo para sumar el porcentaje al costo y uno negativo para restar el porcentaje del costo.">

                    <f:validateDoubleRange minimum="-9999999999999999999.9999"
                                           maximum="9999999999999999999.9999" />
                </p:inputText>
                <p:message for="porcentajeCostoField"/>
            </p:panelGrid >
            <p:commandButton id="aplicarCambios"
                             value="#{msg.aplicarCambios}"
                             action="#{productosPreciosBean.actualizarPrecios}"
                             icon="ui-icon-check"
                             update="@form"
                             ajax="true"
                             />
        </p:panel>
    </h:form>


</html>
