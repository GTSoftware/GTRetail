<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core">

    <h:form id="formContenido">
        <p:panel header="#{msg.edicionCliente}">
            <p:tabView >
                <p:tab title="Datos filiatorios">
                    <h:panelGrid columns="2">
                        <h:outputLabel value="#{msg.idCliente}" />
                        <p:inputText id="idClienteField" value="#{clientesEditBean.clienteActual.idPersona}" readonly="true" required="false"/>
                        <h:outputLabel value="#{msg.tipoPersoneria}" />
                        <p:selectOneMenu required="true" requiredMessage="#{msg.tipoPersoneriaRequerido}" value="#{clientesEditBean.clienteActual.idTipoPersoneria}" converter="#{legalTiposPersoneriaConverter}"
                                         filter="true" filterMatchMode="contains">
                            <f:selectItem  noSelectionOption="true" itemLabel="#{msg.seleccionarUno}" />
                            <f:selectItems value="#{clientesEditBean.tiposPersoneriaList}" var="personeria" itemLabel="#{personeria.nombreTipo}" itemValue="#{personeria}"/>
                            <p:ajax update="generoField"  
                                    process="@this" />
                        </p:selectOneMenu>    
                        <h:outputLabel value="#{msg.razonSocial}"/>
                        <p:inputText id="razonSocialField" value="#{clientesEditBean.clienteActual.razonSocial}" maxlength="200"/>
                        <h:outputLabel value="#{msg.nombreFantasia}"/>
                        <p:inputText id="nombreFantasiaField" value="#{clientesEditBean.clienteActual.nombreFantasia}" maxlength="200"/>
                        <h:outputLabel value="#{msg.apellidos}"/>
                        <p:inputText id="apellidoField" value="#{clientesEditBean.clienteActual.apellidos}" maxlength="50"/>
                        <h:outputLabel value="#{msg.nombres}"/>
                        <p:inputText id="nombreField" value="#{clientesEditBean.clienteActual.nombres}" maxlength="50"/>

                        <h:outputLabel value="#{msg.responsabilidadIVA}"/>
                        <p:selectOneMenu id="responsabilidadIVAField" required="true" requiredMessage="#{msg.responsabilidadIVARequerido}" value="#{clientesEditBean.clienteActual.idResponsabilidadIva}" converter="#{fiscalResponsabilidadesIvaConverter}">
                            <f:selectItem  noSelectionOption="true" itemLabel="#{msg.seleccionarUno}" />
                            <f:selectItems value="#{clientesEditBean.responsabilidadesIVAList}"  var="responsabilidadIva" itemLabel="#{responsabilidadIva.nombreResponsabildiad}" itemValue="#{responsabilidadIva}"/>
                        </p:selectOneMenu>                         


                        <h:outputLabel value="#{msg.genero}" />
                        <p:selectOneMenu id="generoField" required="true" requiredMessage="#{msg.generoRequerido}" value="#{clientesEditBean.clienteActual.idGenero}" converter="#{legalGenerosConverter}">
                            <f:selectItem  noSelectionOption="true" itemLabel="#{msg.seleccionarUno}" />
                            <f:selectItems value="#{clientesEditBean.generosList}" var="genero" itemLabel="#{genero.nombreGenero.concat(' - ').concat(genero.simbolo)}" itemValue="#{genero}" />
                        </p:selectOneMenu>  

                        <h:outputLabel value="#{msg.tipoDocumento}" />
                        <p:selectOneMenu id="tipoDocumentoField" required="true" requiredMessage="#{msg.tipoDocumentoRequerido}" value="#{clientesEditBean.clienteActual.idTipoDocumento}" converter="#{legalTiposDocumentoConverter}">
                            <f:selectItems value="#{clientesEditBean.tiposDocumentoList}" var="tipoDoc" itemLabel="#{tipoDoc.nombreTipoDocumento}" itemValue="#{tipoDoc}"/>
                        </p:selectOneMenu>                         

                        <h:outputLabel value="#{msg.documento}" />
                        <p:inputText  id="nroDocField" value="#{clientesEditBean.clienteActual.documento}" required="true" requiredMessage="#{msg.documentoRequerido}" maxlength="11" />


                        <h:outputLabel value="#{msg.pais}" />
                        <p:selectOneMenu required="true" requiredMessage="#{msg.paisRequerido}" value="#{clientesEditBean.clienteActual.idPais}" converter="#{ubicacionPaisesConverter}" 
                                         filter="true"  filterMatchMode="contains">
                            <f:selectItem  noSelectionOption="true" itemLabel="#{msg.seleccionarUno}" />
                            <f:selectItems value="#{clientesEditBean.paisesList}" var="pais" itemLabel="#{pais.nombrePais}" itemValue="#{pais}"/>
                            <p:ajax update="provinciaField localidadField"  
                                    process="@this" />
                        </p:selectOneMenu>                         

                        <h:outputLabel value="#{msg.provincia}" />
                        <p:selectOneMenu id="provinciaField" required="true" requiredMessage="#{msg.provinciaRequerido}" value="#{clientesEditBean.clienteActual.idProvincia}" converter="#{ubicacionProvinciasConverter}" 
                                         filter="true" filterMatchMode="contains">
                            <f:selectItem  noSelectionOption="true" itemLabel="#{msg.seleccionarUno}" />
                            <f:selectItems value="#{clientesEditBean.provinciasList}" var="prov" itemLabel="#{prov.nombreProvincia}" itemValue="#{prov}"/>
                            <p:ajax update="localidadField"  
                                    process="@this" />
                        </p:selectOneMenu>                         
                        <h:outputLabel value="#{msg.localidad}" />
                        <p:selectOneMenu id="localidadField" required="true" requiredMessage="#{msg.localidadRequerido}" value="#{clientesEditBean.clienteActual.idLocalidad}" converter="#{ubicacionLocalidadesConverter}" 
                                         filter="true" filterMatchMode="contains">
                            <f:selectItem  noSelectionOption="true" itemLabel="#{msg.seleccionarUno}" />
                            <f:selectItems value="#{clientesEditBean.localidadesList}" var="loca" itemLabel="#{loca.nombreLocalidad}" itemValue="#{loca}" />
                        </p:selectOneMenu>    

                        <h:outputLabel value="#{msg.calle}"/>
                        <p:inputText id="calleField" value="#{clientesEditBean.clienteActual.calle}" required="true" requiredMessage="#{msg.calleRequerido}"/>
                        <h:outputLabel value="#{msg.altura}"/>
                        <p:inputText id="alturaField" value="#{clientesEditBean.clienteActual.altura}" />
                        <h:outputLabel value="#{msg.depto}"/>
                        <p:inputText id="pisoField" value="#{clientesEditBean.clienteActual.piso}" />
                        <h:outputLabel value="#{msg.piso}"/>
                        <p:inputText id="deptoField" value="#{clientesEditBean.clienteActual.depto}" />

                        <h:outputLabel value="#{msg.fechaAlta}" />
                        <p:calendar id="fechaAlta"  value="#{clientesEditBean.clienteActual.fechaAlta}" readonly="true" required="false"/>
                        <h:outputLabel value="#{msg.activo}" />
                        <p:selectBooleanCheckbox  id="activoField"  value="#{clientesEditBean.clienteActual.activo}"  disabled="true" required="false"/>

                    </h:panelGrid>
                </p:tab>
                <p:tab title="Contacto" >
                       <p:commandButton id="nuevoTelefonoButton" action="#{clientesEditBean.nuevoTelefono()}" value="#{msg.nuevo}"  icon="ui-icon-plus" update="telefonosTable" />
                    <p:dataTable id="telefonosTable" value="#{clientesEditBean.clienteActual.personasTelefonosList}" var="telefono"
                                 rows="15"
                                 paginator="true"
                                 sortMode="multiple"
                                 emptyMessage="#{msg.telefonosEmpty}"
                                 rowKey="#{telefono.idTelefono}"
                                 paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"  
                                 rowsPerPageTemplate="10,15,30"
                                 style="width: 100%"
                                 resizableColumns="true"
                                 scrollable="true"
                                 editable="true"
                                 >

                        <p:column sortBy="#{telefono.numero}" >
                            <f:facet name="header">
                                #{msg.telefonoNumero}
                            </f:facet>
                            <p:cellEditor>
                                <f:facet name="output"><h:outputText value="#{telefono.numero}" /></f:facet>
                                <f:facet name="input"><p:inputText id="telefonoField" value="#{telefono.numero}"
                                                                   required="true" maxlength="50" style="width:100%"/></f:facet>
                            </p:cellEditor>

                        </p:column>
                        <p:column sortBy="#{telefono.referencia}" >
                            <f:facet name="header">
                                #{msg.telefonoReferencia}
                            </f:facet>
                            <p:cellEditor>
                                <f:facet name="output"><h:outputText value="#{telefono.referencia}" /></f:facet>
                                <f:facet name="input"><p:inputText id="referenciaField" value="#{telefono.referencia}"
                                                                   maxlength="100" style="width:100%"/></f:facet>
                            </p:cellEditor>
                        </p:column>
                        <p:column style="width: 5%" >
                            <f:facet name="header">
                                #{msg.acciones}
                            </f:facet>
                            <p:rowEditor />
                            <p:commandButton icon="ui-icon-trash" action="#{clientesEditBean.borrarTelefono(telefono)}"  update="telefonosTable" />
                        </p:column>
                    </p:dataTable>
                </p:tab>
            </p:tabView>
            <p:separator/>
            <p:commandButton value="#{msg.guardar}" icon="ui-icon-disk" action="#{clientesEditBean.doGuardarCliente()}" />
            <p:commandButton value="#{msg.cancelar}" icon="ui-icon-cancel" action="consultaClientes.xhtml" ajax="false" immediate="true"/>

        </p:panel>

    </h:form>
</html>

